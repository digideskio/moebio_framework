<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Moebio Framework: Source: operators/strings/StringOperators.js</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:700italic,400,700' rel='stylesheet' type='text/css'>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/style.css">
</head>

<body onload="prettyPrint()">

<div class='hide-mobile pin-left pint-top pin-bottom col2 quiet-scroll scroll-styled fixed'>

  <div class='clearfix fill-background dark center'>
    <div class='inline pad2y'>
      <a href="../">Moebio Framework</a> / <a href="index.html">Docs</a>
    </div>
  </div>
  <div class='pad1 small'>
    <div class="filter-block clearfix">
      <input type="text" id="filter-input" placeholder="Type to filter">
      <a href="#" id="clear-filter-button">x</a>
    </div>
    <div class='side'>
      <h3>Numbers</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="Axis2D.html">Axis2D</a></li><li class="code"><a href="Interval.html">Interval</a></li><li class="code"><a href="Matrix.html">Matrix</a></li><li class="code"><a href="NumberList.html">NumberList</a></li><li class="code"><a href="NumberTable.html">NumberTable</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="IntervalListOperators.html">IntervalListOperators</a></li><li class="code"><a href="IntervalTableOperators.html">IntervalTableOperators</a></li><li class="code"><a href="MatrixGenerators.html">MatrixGenerators</a></li><li class="code"><a href="NumberListConversions.html">NumberListConversions</a></li><li class="code"><a href="NumberListGenerators.html">NumberListGenerators</a></li><li class="code"><a href="NumberListOperators.html">NumberListOperators</a></li><li class="code"><a href="NumberOperators.html">NumberOperators</a></li><li class="code"><a href="NumberTableConversions.html">NumberTableConversions</a></li><li class="code"><a href="NumberTableFlowOperators.html">NumberTableFlowOperators</a></li><li class="code"><a href="NumberTableOperators.html">NumberTableOperators</a></li></ul></div><h3>Colors</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="ColorList.html">ColorList</a></li><li class="code"><a href="ColorScale.html">ColorScale</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="ColorGenerators.html">ColorGenerators</a></li><li class="code"><a href="ColorListGenerators.html">ColorListGenerators</a></li><li class="code"><a href="ColorListOperators.html">ColorListOperators</a></li><li class="code"><a href="ColorOperators.html">ColorOperators</a></li><li class="code"><a href="ColorScaleGenerators.html">ColorScaleGenerators</a></li><li class="code"><a href="ColorScales.html">ColorScales</a></li></ul></div><h3>Geo</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="Country.html">Country</a></li><li class="code"><a href="CountryList.html">CountryList</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="CountryListOperators.html">CountryListOperators</a></li><li class="code"><a href="CountryOperators.html">CountryOperators</a></li><li class="code"><a href="GeoOperators.html">GeoOperators</a></li></ul></div><h3>Basics</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="DataModel.html">DataModel</a></li><li class="code"><a href="List.html">List</a></li><li class="code"><a href="Table.html">Table</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="ListConversions.html">ListConversions</a></li><li class="code"><a href="ListGenerators.html">ListGenerators</a></li><li class="code"><a href="ListOperators.html">ListOperators</a></li><li class="code"><a href="ObjectConversions.html">ObjectConversions</a></li><li class="code"><a href="ObjectOperators.html">ObjectOperators</a></li><li class="code"><a href="TableConversions.html">TableConversions</a></li><li class="code"><a href="TableEncodings.html">TableEncodings</a></li><li class="code"><a href="TableGenerators.html">TableGenerators</a></li><li class="code"><a href="TableOperators.html">TableOperators</a></li></ul></div><h3>Dates</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="DateAxis.html">DateAxis</a></li><li class="code"><a href="DateInterval.html">DateInterval</a></li><li class="code"><a href="DateList.html">DateList</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="DateListConversions.html">DateListConversions</a></li><li class="code"><a href="DateListOperators.html">DateListOperators</a></li><li class="code"><a href="DateOperators.html">DateOperators</a></li></ul></div><h3>Drawing</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="DragDetection.html">DragDetection</a></li><li class="code"><a href="Graphics.html">Graphics</a></li><li class="code"><a href="InputTextFieldHTML.html">InputTextFieldHTML</a></li><li class="code"><a href="TextBox.html">TextBox</a></li><li class="code"><a href="TextFieldHTML.html">TextFieldHTML</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="CircleDraw.html">CircleDraw</a></li><li class="code"><a href="ColorsDraw.html">ColorsDraw</a></li><li class="code"><a href="Draw.html">Draw</a></li><li class="code"><a href="DrawTexts.html">DrawTexts</a></li><li class="code"><a href="DrawTextsAdvanced.html">DrawTextsAdvanced</a></li><li class="code"><a href="ListDraw.html">ListDraw</a></li><li class="code"><a href="NetworkDraw.html">NetworkDraw</a></li><li class="code"><a href="ObjectDraw.html">ObjectDraw</a></li><li class="code"><a href="StringDraw.html">StringDraw</a></li><li class="code"><a href="StringListDraw.html">StringListDraw</a></li><li class="code"><a href="TreeDraw.html">TreeDraw</a></li></ul></div><h3>Geometry</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="Engine3D.html">Engine3D</a></li><li class="code"><a href="Point.html">Point</a></li><li class="code"><a href="Point3D.html">Point3D</a></li><li class="code"><a href="Polygon.html">Polygon</a></li><li class="code"><a href="Polygon3D.html">Polygon3D</a></li><li class="code"><a href="Polygon3DList.html">Polygon3DList</a></li><li class="code"><a href="PolygonList.html">PolygonList</a></li><li class="code"><a href="Rectangle.html">Rectangle</a></li><li class="code"><a href="RectangleList.html">RectangleList</a></li><li class="code"><a href="Space2D.html">Space2D</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="GeometryConversions.html">GeometryConversions</a></li><li class="code"><a href="GeometryOperators.html">GeometryOperators</a></li><li class="code"><a href="PointOperators.html">PointOperators</a></li><li class="code"><a href="PolygonGenerators.html">PolygonGenerators</a></li><li class="code"><a href="PolygonListEncodings.html">PolygonListEncodings</a></li><li class="code"><a href="PolygonListOperators.html">PolygonListOperators</a></li><li class="code"><a href="PolygonOperators.html">PolygonOperators</a></li><li class="code"><a href="RectangleOperators.html">RectangleOperators</a></li></ul></div><h3>Networks</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="Forces.html">Forces</a></li><li class="code"><a href="Network.html">Network</a></li><li class="code"><a href="Node.html">Node</a></li><li class="code"><a href="NodeList.html">NodeList</a></li><li class="code"><a href="Relation.html">Relation</a></li><li class="code"><a href="RelationList.html">RelationList</a></li><li class="code"><a href="Tree.html">Tree</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="NetworkConversions.html">NetworkConversions</a></li><li class="code"><a href="NetworkEncodings.html">NetworkEncodings</a></li><li class="code"><a href="NetworkGenerators.html">NetworkGenerators</a></li><li class="code"><a href="NetworkOperators.html">NetworkOperators</a></li><li class="code"><a href="TreeConversions.html">TreeConversions</a></li><li class="code"><a href="TreeEncodings.html">TreeEncodings</a></li></ul></div><h3>Misc</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="LoadEvent.html">LoadEvent</a></li><li class="code"><a href="MultiLoader.html">MultiLoader</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="FastHtml.html">FastHtml</a></li></ul></div><h3>Strings</h3>
<div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Classes</strong></div><ul>
<li class="code"><a href="StringList.html">StringList</a></li></ul></div><div class="space-bottom1"><div class="pad0y"><strong class="capitalize" keyline-all>Namespaces</strong></div><ul>
<li class="code"><a href="StringConversions.html">StringConversions</a></li><li class="code"><a href="StringListConversions.html">StringListConversions</a></li><li class="code"><a href="StringListOperators.html">StringListOperators</a></li><li class="code"><a href="StringOperators.html">StringOperators</a></li><li class="code"><a href="StringUtils.html">StringUtils</a></li></ul></div><h3>Functions</h3><ul><li class="small"><a href="global.html#getStructureLocalStorage">getStructureLocalStorage</a></li><li class="small"><a href="global.html#getStructureLocalStorageFromSeed">getStructureLocalStorageFromSeed</a></li><li class="small"><a href="global.html#setStructureLocalStorage">setStructureLocalStorage</a></li><li class="small"><a href="global.html#setStructureLocalStorageWithSeed">setStructureLocalStorageWithSeed</a></li></ul></div>
    </div>
  </div>
</div>
<div class='limiter margin2'>
    <div class='pad1y pad2x fill-white'>
      <div class='prose'>
        <div class='pad2y'>
          <h1 class='code'>Source: operators/strings/StringOperators.js</h1>
        </div>
        



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import StringList from "src/dataTypes/strings/StringList";
import ListOperators from "src/operators/lists/ListOperators";
import NumberList from "src/dataTypes/numeric/NumberList";
import ColorListGenerators from "src/operators/graphic/ColorListGenerators";
import ColorOperators from "src/operators/graphic/ColorOperators";
import Table from "src/dataTypes/lists/Table";

/**
 * @classdesc  String Operators
 *
 * @namespace
 * @category strings
 */
function StringOperators() {}
export default StringOperators;

StringOperators.ENTER = String.fromCharCode(13);
StringOperators.ENTER2 = String.fromCharCode(10);
StringOperators.ENTER3 = String.fromCharCode(8232);

StringOperators.SPACE = String.fromCharCode(32);
StringOperators.SPACE2 = String.fromCharCode(160);

StringOperators.TAB = "	";
StringOperators.TAB2 = String.fromCharCode(9);

StringOperators.LINK_REGEX = /(^|\s+)(https*\:\/\/\S+[^\.\s+])/;
StringOperators.MAIL_REGEX = /^(([^&lt;>()[\]\\.,;:\s@\"]+(\.[^&lt;>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
StringOperators.STOP_WORDS = StringList.fromArray("t,s,mt,rt,re,m,http,amp,a,able,about,across,after,all,almost,also,am,among,an,and,any,are,as,at,be,because,been,but,by,can,cannot,could,dear,did,do,does,either,else,ever,every,for,from,get,got,had,has,have,he,her,hers,him,his,how,however,i,if,in,into,is,it,its,just,least,let,like,likely,may,me,might,most,must,my,neither,no,nor,not,of,off,often,on,or,other,our,own,rather,said,say,says,she,should,since,so,some,than,that,the,their,them,then,there,these,they,this,tis,to,too,twas,us,wants,was,we,were,what,when,where,which,while,who,whom,why,will,with,would,yet,you,your".split(","));



/**
 * creates an html string that depicts a proprtions bar with colors for categories
 * @param  {NumberList} normalizedWeights normalized weights
 *
 * @param  {Number} nChars width in characters
 * @param  {ColorList} colors list of categorical colors
 * @param  {String} character character or characters to be used as primitive
 * @return {String} html depciting colored segments forming a bar in a single line
 */
StringOperators.createsCategoricalColorsBlocksHtml = function(normalizedWeights, nChars, colors, character){
  if(normalizedWeights==null) return "";

  var bars="";

  nChars = nChars==null?20:nChars;
  colors = colors==null?ColorListGenerators.createDefaultCategoricalColorList(normalizedWeights.length):colors;
  character = character==null?"█":character;

  normalizedWeights.forEach(function(w, j){
    w = Math.floor(w*nChars) +  ( (w*nChars - Math.floor(w*nChars))>Math.random()?1:0 );
    bars += "&lt;font color=\""+ColorOperators.colorStringToHEX(colors[j])+"\">";
    for(var i=0; i&lt;w; i++){
      bars += character;
    }
    bars += "&lt;/f>";
  });

  return bars;
};

/**
 * splits a String by a character (entre by default)
 * @param  {String} string
 *
 * @param  {String} character
 * @return {StringList}
 * tags:
 */
StringOperators.split = function(string, character) {
  if(character == null) return StringOperators.splitByEnter(string);
  return StringList.fromArray(string.split(character));
};


/**
 * split a String by enter (using several codifications)
 * @param  {String} string
 * @return {StringList}
 * tags:
 */
StringOperators.splitByEnter = function(string) {
  if(string == null) {
    return null;
  }
  var stringList = StringOperators.splitString(string, "\n");
  if(stringList.length > 1)
  {
   return stringList;
  }
  stringList = StringOperators.splitString(string, StringOperators.ENTER2);
  if(stringList.length > 1) {
    return stringList;
  }
  stringList = StringOperators.splitString(string, StringOperators.ENTER3);
  if(stringList.length > 1) {
    return stringList;
  }
  return new StringList(string);
};


/**
 * replaces in a string ocurrences of a sub-string by another string (base in replace JavaScript method)
 * @param  {String} text to be modified
 * @param  {String} string string to be replaced (could be Regular Expression)
 * @param  {String} replacement string to be placed instead
 * @return {String}
 * tags:
 */
StringOperators.replaceStringInText = function(text, string, replacement) {
  if(text == null || string == null || replacement == null) return null;

  if(!(string instanceof RegExp)) string = new RegExp(string, "g");

  return text.replace(string, replacement);
};

/**
 * replaces in each string, a sub-string by a string
 * @param  {String} text where to replaces strings
 * @param  {StringList} strings to be replaced (could be Regular Expressions)
 * @param  {String} replacement string to be placed instead
 * @return {String}
 * tags:
 */
StringOperators.replaceStringsInText = function(text, strings, replacement) {
  if(text==null || strings==null || replacement==null) return null;

  var newText = text;
  var nStrings = strings.length;
  var j;
  var string;

  for(j=0; j&lt;nStrings; j++){
    string = strings[j];
    if(!(string instanceof RegExp)) string = new RegExp(string, "g");
    newText = newText.replace(string, replacement);
  }

  return newText;
};

/** depracted, replaced by StringListOperators.replaceStringsInText
 * replaces in a string ocurrences of sub-strings by a string
 * @param  {String} string to be modified
 * @param  {StringList} subStrings sub-strings to be replaced
 * @param  {String} replacement string to be placed instead
 * @return {String}
 */
// StringOperators.replaceSubStringsByString = function(string, subStrings, replacement) {
//   if(subStrings == null) return;

//   subStrings.forEach(function(subString) {
//     string = StringOperators.replaceStringInText(string, subString, replacement);
//   });

//   return string;
// };

/** deprecated, replaced by: 
 * replaces in a string ocurrences of sub-strings by strings (1-1)
 * @param  {String} string to be modified
 * @param  {StringList} subStrings sub-strings to be replaced
 * @param  {StringList} replacements strings to be placed instead
 * @return {String}
 * tags:
 */
// StringOperators.replaceSubStringsByStrings = function(string, subStrings, replacements) {
//   if(subStrings == null || replacements == null) return;

//   var nElements = Math.min(subStrings.length, replacements.length);
//   var i;

//   for(i = 0; i &lt; nElements; i++) {
//     string = StringOperators.replaceStringInText(string, subStrings[i], replacements[i]);
//   }

//   return string;
// };

/**
 * builds a stringList of words contained in the text
 * @param  {String} string text to be analyzed
 *
 * @param  {Boolean} withoutRepetitions remove words repetitions
 * @param  {Boolean} stopWords remove stop words
 * @param  {Boolean} sortedByFrequency  sorted by frequency in text
 * @param  {Boolean} includeLinks include html links
 * @param  {Number} limit of words
 * @param  {Number} minSizeWords minimal number of characters of words
 * @return {StringList}
 * tags:
 */
StringOperators.getWords = function(string, withoutRepetitions, stopWords, sortedByFrequency, includeLinks, limit, minSizeWords) {
  if(string == null) return null;

  var links;

  minSizeWords = minSizeWords || 0;
  withoutRepetitions = withoutRepetitions == null ? true : withoutRepetitions;
  sortedByFrequency = sortedByFrequency == null ? true : sortedByFrequency;
  includeLinks = includeLinks == null ? true : includeLinks;
  limit = limit == null ? 0 : limit;

  var i, j;

  if(includeLinks) {
    links = string.match(StringOperators.LINK_REGEX);
  }
  string = string.toLowerCase().replace(StringOperators.LINK_REGEX, "");

  var list = string.match(/\w+/g);
  if(list == null) return new StringList();

  list = StringList.fromArray(list);

  if(includeLinks &amp;&amp; links != null) list = list.concat(links);
  list = StringList.fromArray(list).replace(/ /g, "");

  var nMatches;

  if(stopWords != null) { //TODO:check before if all stopwrds are strings
    //list.removeElements(stopWords);
    nMatches = list.length;
    for(i = 0; i&lt;nMatches; i++) {
      for(j = 0; stopWords[j] != null; j++) {
        if((typeof stopWords[j]) == 'string') {
          if(stopWords[j] == list[i]) {
            list.splice(i, 1);
            i--;
            nMatches = list.length;
            break;
          }
        } else if(stopWords[j].test(list[i])) {
          list.splice(i, 1);
          i--;
          nMatches = list.length;
          break;
        }
      }
    }

  }

  if(minSizeWords > 0) {
    nMatches = list.length;
    for(i = 0; list[i] != null; i++) {
      if(list[i].length &lt; minSizeWords) {
        list.splice(i, 1);
        i--;
        nMatches = list.length;
      }
    }
  }

  if(sortedByFrequency) {
    if(withoutRepetitions) {
      list = list.getFrequenciesTable(true)[0];// //ListOperators.countElementsRepetitionOnList(list, true)[0];
      if(limit !== 0) list = list.substr(0, limit);

      return list;
    }

    var occurrences = list.getFrequenciesTable();
    list = list.getSortedByList(occurrences);
    if(limit !== 0) list = list.substr(0, limit);

    return list;
  }

  if(withoutRepetitions) {
    list = list.getWithoutRepetitions();
  }

  if(limit !== 0) list = list.splice(0, limit);
  return list;
};



/**
 * return a substring
 * @param  {String} string
 *
 * @param  {Number} i0 init index
 * @param  {Number} length of ths substring (if null returns substring from i0 to the end)
 * @return {String}
 * tags:filter
 */
StringOperators.substr = function(string, i0, length) {
  i0 = i0 || 0;
  return string.substr(i0, length);
};

/**
 * split a String by a separator (a String) and returns a StringList
 * @param  {String} string
 *
 * @param  {String} separator
 * @return {StringList}
 * tags:
 */
StringOperators.splitString = function(string, separator) {
  if(string == null) return null;
  if(separator == null) separator = ",";
  if(typeof separator == "string") separator = separator.replace("\\n", "\n");
  if(string.indexOf(separator) == -1) return new StringList(string);
  return StringList.fromArray(string.split(separator));
};

/**
 * searches for two Strings within a String and returns the String in between
 * @param  {String} text
 * @param  {String} subString0
 *
 * @param  {String} subString1 if null returns the text after subString0
 * @return {String}
 * tags:filter
 */
StringOperators.getFirstTextBetweenStrings = function(text, subString0, subString1) {
  var i0 = text.indexOf(subString0);
  if(i0 == -1) return null;
  if(subString1 === "" || subString1 == null) return text.substr(i0 + subString0.length);
  var i1 = text.indexOf(subString1, i0 + subString0.length + 1);
  if(i1 == -1) return text.substring(i0 + subString0.length);
  return text.substr(i0 + subString0.length, i1 - (i0 + subString0.length));
};

/**
 * searches all the Strings contained between two Strings in a String
 * @param  {String} text
 * @param  {String} subString0
 * @param  {String} subString1
 * @return {StringList}
 * tags:filter
 */
StringOperators.getAllTextsBetweenStrings = function(text, subString0, subString1) { //TODO: improve using indexOf(string, START_INDEX)
  if(text.indexOf(subString0) == -1) return new StringList();
  var blocks = text.split(subString0);
  var nBlocks = blocks.length;
  var stringList = new StringList();
  var block;
  var index;
  var i;
  for(i = 1; i &lt; nBlocks; i++) {
    block = blocks[i];
    if(subString1 == subString0) {
      stringList.push(block);
    } else {
      index = block.indexOf(subString1);
      if(index >= 0) {
        stringList.push(block.substr(0, index));
      }
    }
  }
  return stringList;
};

/**
 * associates a value to each text in a StringList, according to number of words containg in each StringList; one lists pushes to negative values, the other to positive. A classic use would be a primitive sentimental analisis using a list of positive adjectives and a list of negative ones
 * @param  {String} string to be analized
 * @param  {StringList} negativeStrings list of 'negative' words
 * @param  {StringList} positiveStrings list of 'positive' words
 *
 * @param  {Boolean} normalizeBySize divide score by the string size
 * @return {Number}
 * tags:analysis
 */
StringOperators.countWordsDichotomyAnalysis = function(string, negativeStrings, positiveStrings, normalizeBySize) {
  var val = 0;
  negativeStrings.forEach(function(word) {
    val -= StringOperators.countWordOccurrences(string, word);
  });
  positiveStrings.forEach(function(word) {
    val += StringOperators.countWordOccurrences(string, word);
  });
  if(normalizeBySize) val /= string.length;
  return val;
};


/**
 * creates a list of urls contained in the html in &lt;a> tags
 * @param  {String} html to be analyzied
 *
 * @param {String} urlSource optional, if provided will be used to build complete urls
 * @param {Boolean} removeHash if true removes the hastag (anchor) content of the url
 * @return {StringList} list of urls
 * tags:html
 */
StringOperators.getLinksFromHtml = function(html, urlSource, removeHash) {
  var doc = document.createElement("html");
  doc.innerHTML = html;

  var i;
  var links = doc.getElementsByTagName("a");
  var originalUrl, url;
  var urls = new StringList();
  var index;
  var urlSourceParts;
  var parts, blocks;
  var root;

  urlSource = urlSource === "" ? null : urlSource;
  removeHash = removeHash == null ? false : removeHash;

  if(urlSource) {
    urlSource = urlSource.trim();

    if(urlSource.substr(-5) == ".html") {
      urlSourceParts = urlSource.split("/");
      urlSource = urlSourceParts.slice(0, urlSourceParts.length - 1).join("/");
    }
    if(urlSource.indexOf(-1) == "/") urlSource = urlSource.substr(0, urlSource.length - 1);
    urlSourceParts = urlSource.split("/");

    root = urlSource.replace("//", "**").split("/")[0].replace("**", "//");
  }


  for(i = 0; i &lt; links.length; i++) {
    originalUrl = url = links[i].getAttribute("href");
    if(url == null) continue;

    if(url.indexOf('=') != -1) url = url.split('=')[0];

    //console.log(url);
    if(urlSource &amp;&amp; url.indexOf('http://') == -1 &amp;&amp; url.indexOf('https://') == -1 &amp;&amp; url.indexOf('wwww.') == -1 &amp;&amp; url.indexOf('file:') == -1 &amp;&amp; url.indexOf('gopher:') == -1 &amp;&amp; url.indexOf('//') !== 0) {
      if(url.substr(0, 9) == "../../../") {
        url = urlSourceParts.slice(0, urlSourceParts.length - 3).join("/") + "/" + url.substr(9);
      } else if(url.substr(0, 6) == "../../") {
        url = urlSourceParts.slice(0, urlSourceParts.length - 2).join("/") + "/" + url.substr(6);
      } else if(url.substr(0, 3) == "../") {
        url = urlSourceParts.slice(0, urlSourceParts.length - 1).join("/") + "/" + url.substr(3);
      } else if(url.charAt(0) == "/") {
        url = root + url;
      } else {
        url = urlSource + "/" + url;
      }
    }
    if(removeHash &amp;&amp; url.indexOf("#") != -1) url = url.split('#')[0];
    if(url.substr(-1) == "/") url = url.substr(0, url.length - 1);

    index = url.indexOf('/../');
    while(index != -1) {
      blocks = url.split('/../');
      parts = blocks[0].replace("//", "**").split("/");
      url = parts.slice(0, parts.length - 1).join("/").replace("**", "//") + ("/" + blocks.slice(1).join("/../"));
      index = url.indexOf('/../');
    }

    if(url.indexOf('./') != -1) {
      parts = url.replace("//", "**").split("/");
      if(parts[0].substr(-1) == ".") {
        parts[0] = parts[0].substr(0, parts[0].length - 1);
        url = parts.join('/').replace("**", "//");
      }
    }

    url = url.trim();

    if(url.substr(-1) == "/") url = url.substr(0, url.length - 1);

    if(url == urlSource) continue;
    //console.log(urlSource+' | '+originalUrl+' -> '+url);
    urls.push(url);
  }

  urls = urls.getWithoutRepetitions();

  return urls;
};


/**
 * validates is string contains another string, as string or word (space or punctuation boundaries)
 * @param {String} text string to be validated
 * @param {String} string string or word to be searched
 *
 * @param {Boolean} asWord if true a word will be searched (false by default)
 * @param {Boolean} caseSensitive (false by default)
 * @return {Boolean} returns true if string or word is contained
 */
StringOperators.textContainsString = function(text, string, asWord, caseSensitive) {
  text = caseSensitive ? string : text.toLowerCase();
  string = caseSensitive ? string : string.toLowerCase();
  return asWord ?
    text.match(new RegExp("\\b" + string + "\\b")).length > 0 :
    text.indexOf(string) != -1;
};

/**
 * print a string in console
 * @param  {String} string to be printed in console
 * @param  {Boolean} frame  if true (default) prints ///////////////// on top and bottom
 * tags:
 */
StringOperators.logInConsole = function(string, frame) {
  frame = frame == null ? true : frame;
  if(frame) console.log('///////////////////////////////////////////////////');
  console.log(string);
  if(frame) console.log('///////////////////////////////////////////////////');
};




//////


/**
 * @todo finish docs
 */
StringOperators.getParenthesisContents = function(text, brackets) {
  var contents = new StringList();

  var subText = text;

  var contentObject = StringOperators.getFirstParenthesisContentWithIndexes(text, brackets);

  var nAttempts = 0;
  while(contentObject.content !== "" &amp;&amp; contentObject.index1 &lt; subText.length - 1 &amp;&amp; nAttempts &lt; text.length) {
    contents.push(contentObject.content);
    subText = subText.substr(contentObject.index1 + 2);
    contentObject = StringOperators.getFirstParenthesisContentWithIndexes(subText, brackets);
    nAttempts++;
  }

  return contents;
};

/**
 * @todo finish docs
 */
StringOperators.getFirstParenthesisContent = function(text, brackets) {
  return StringOperators.getFirstParenthesisContentWithIndexes(text, brackets).content;
};

/**
 * @todo finish docs
 */
StringOperators.getFirstParenthesisContentWithIndexes = function(text, brackets) {
  var open = brackets ? "[" : "(";
  var close = brackets ? "]" : ")";

  var openRegEx = brackets ? /\[/g : /\(/g;
  var closeRegEx = brackets ? /\]/g : /\)/g;

  var indexOpen = text.indexOf(open);

  if(indexOpen == -1) return {
    "content": "",
    "index0": 0,
    "index1": 0
  };

  var indexClose = text.indexOf(close);

  var part = text.substring(indexOpen + 1, indexClose);

  var openMatch = part.match(openRegEx);
  var closeMatch = part.match(closeRegEx);

  var nOpen = (openMatch == null ? 0 : openMatch.length) - (closeMatch == null ? 0 : closeMatch.length);
  var nAttempts = 0;


  while((nOpen > 0 || indexClose == -1) &amp;&amp; nAttempts &lt; text.length) {
    indexClose = text.indexOf(close, indexClose);
    part = text.substring(indexOpen + 1, indexClose + 1);
    indexClose++;
    openMatch = part.match(openRegEx);
    closeMatch = part.match(closeRegEx);
    nOpen = (openMatch == null ? 0 : openMatch.length) - (closeMatch == null ? 0 : closeMatch.length);

    nAttempts++;
  }
  indexClose = text.indexOf(close, indexClose);

  return {
    "content": indexClose == -1 ? text.substring(indexOpen + 1) : text.substring(indexOpen + 1, indexClose),
    "index0": indexOpen + 1,
    "index1": indexClose == -1 ? (text.length - 1) : (indexClose - 1)
  };
};

/**
 * @todo finish docs
 */
StringOperators.placeString = function(string, stringToPlace, index) {
  return string.substr(0, index) + stringToPlace + string.substr(index + stringToPlace.length);
};

/**
 * @todo finish docs
 */
StringOperators.insertString = function(string, stringToInsert, index) {
  return string.substr(0, index) + stringToInsert + string.substr(index);
};

/**
 * transforms a text by performing multiple optional cleaning operations (applied in the same order as parameters suggest)
 * @param {String} string to be transformed
 *
 * @param {Boolean} removeEnters
 * @param {Boolean} removeTabs
 * @param {String} replaceTabsAndEntersBy
 * @param {Boolean} removePunctuation
 * @param {Boolean} toLowerCase
 * @param {StringList} stopWords removes strings from text
 * @param {Boolean} removeDoubleSpaces
 * @return {String}
 * tags:filter
 */
StringOperators.cleanText = function(string, removeEnters, removeTabs, replaceTabsAndEntersBy, removePunctuation, toLowerCase, stopWords, removeDoubleSpaces){
  if(string==null) return null;

  //console.log("string["+string+"]");

  if(removeEnters) string = StringOperators.removeEnters(string, replaceTabsAndEntersBy);
  if(removeTabs) string = StringOperators.removeTabs(string, replaceTabsAndEntersBy);
  if(removePunctuation) string = StringOperators.removePunctuation(string);
  if(toLowerCase) string = string.toLowerCase();

  if(stopWords!=null){
    string = StringOperators.replaceStringsInText(string, stopWords, "");
  }

  if(removeDoubleSpaces) string = StringOperators.removeDoubleSpaces(string);

  return string;
};

/**
 * removes enters from string
 * @param {String} string to be transformed

 * @param {String} replaceBy optional string to replace enters
 * @return {String}
 * tags:
 */
StringOperators.removeEnters = function(string, replaceBy) {
  replaceBy = replaceBy==null?"":replaceBy;
  return string.replace(/(\StringOperators.ENTER|\StringOperators.ENTER2|\StringOperators.ENTER3)/gi, replaceBy);
};

/**
 * removes tabs from string
 * @param {String} string to be transformed

 * @param {String} replaceBy optional string to replace tabs
 * @return {String}
 * tags:
 */
StringOperators.removeTabs = function(string, replaceBy) {
  replaceBy = replaceBy || "";
  return string.replace(/(\StringOperators.TAB|\StringOperators.TAB2|\t)/gi, replaceBy);
};

/**
 * removes punctuation from a string, using regex /[:,.;?!\(\)\"\']/gi
 * @param {String} string to be transformed

 * @param {String} replaceBy optional string to replace punctuation signs
 * @return {String}
 * tags:
 */
StringOperators.removePunctuation = function(string, replaceBy) {
  replaceBy = replaceBy || "";
  return string.replace(/[:,.;?!\(\)\"\']/gi, replaceBy);
};

/**
 * removes double spaces from a string
 * @param {String} string to be transformed
 * @return {String}
 * tags:
 */
StringOperators.removeDoubleSpaces = function(string) {
  var retString = string;
  var regExpr = RegExp(/  /);
  while(regExpr.test(retString)) {
    retString = retString.replace(regExpr, " ");
  }
  return retString;
};

/**
 * @todo finish docs
 */
StringOperators.removeInitialRepeatedCharacter = function(string, character) {
  while(string.charAt(0) == character) string = string.substr(1);
  return string;
};


/**
 * takes plain text from html
 * @param  {String} html
 * @return {String}
 * tags:
 */
StringOperators.removeHtmlTags = function(html) {
  var tmp = document.createElement("DIV");
  tmp.innerHTML = html;
  return tmp.textContent || tmp.innerText;
};

/**
 * @todo finish docs
 */
StringOperators.removeLinks = function(text) {
  text += ' ';
  var regexp = /https*:\/\/[a-zA-Z0-9\/\.]+( |:|;|\r|\t|\n|\v)/g;
  return(text.replace(regexp, ' ')).substr(0, text.length - 2);
};

/**
 * @todo finish docs
 */
StringOperators.removeQuotes = function(string) { //TODO:improve
  if(string.charAt(0) == "\"") string = string.substr(1);
  if(string.charAt(string.length - 1) == "\"") string = string.substr(0, string.length - 1);
  return string;
};

// StringOperators.trim = function(string){
// 	return string.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
// }



StringOperators.removeAccentsAndDiacritics = function(string) {
  var r = string.replace(new RegExp(/[àáâãäå]/g), "a");
  r = r.replace(new RegExp(/æ/g), "ae");
  r = r.replace(new RegExp(/ç/g), "c");
  r = r.replace(new RegExp(/[èéêë]/g), "e");
  r = r.replace(new RegExp(/[ìíîï]/g), "i");
  r = r.replace(new RegExp(/ñ/g), "n");
  r = r.replace(new RegExp(/[òóôõö]/g), "o");
  r = r.replace(new RegExp(/œ/g), "oe");
  r = r.replace(new RegExp(/[ùúûü]/g), "u");
  r = r.replace(new RegExp(/[ýÿ]/g), "y");

  r = r.replace(new RegExp(/[ÀÁÂÄÃ]/g), "A");
  r = r.replace(new RegExp(/Æ/g), "AE");
  r = r.replace(new RegExp(/Ç/g), "c");
  r = r.replace(new RegExp(/[ÈÉÊË]/g), "E");
  r = r.replace(new RegExp(/[ÌÍÎÏ]/g), "I");
  r = r.replace(new RegExp(/Ñ/g), "N");
  r = r.replace(new RegExp(/[ÒÓÔÖÕ]/g), "O");
  r = r.replace(new RegExp(/Œ/g), "OE");
  r = r.replace(new RegExp(/[ÙÚÛÜ]/g), "U");
  r = r.replace(new RegExp(/[Ÿ]/g), "Y");

  return r;
};

/**
 * creates a table with frequent words and occurrences numbers
 * @param  {String} string text to be analyzed
 *
 * @param  {StringList} stopWords
 * @param  {Boolean} includeLinks
 * @param  {Number} limit max size of rows
 * @param  {Number} minSizeWords
 * @return {Table} contains a list of words, and a numberList of occurrences
 * tags:words
 */
StringOperators.getWordsOccurrencesTable = function(string, stopWords, includeLinks, limit, minSizeWords) {
  if(string == null) return;
  if(string.length === 0) return new Table(new StringList(), new NumberList());
  var words = StringOperators.getWords(string, false, stopWords, false, includeLinks, limit, minSizeWords);
  var table;
  if(limit != null)
    table = words.getFrequenciesTable(true).sliceRows(0, limit-1);
  else
    table = words.getFrequenciesTable(true);
  return table;// ListOperators.countElementsRepetitionOnList(words, true, false, limit);
};

/**
 * @todo finish docs
 */
StringOperators.indexesOf = function(text, string) { //TODO:test
  var index = text.indexOf(string);
  if(index == -1) return new NumberList();
  var indexes = new NumberList(index);
  index = text.indexOf(string, index + 1);
  while(index != -1) {
    indexes.push(index);
    index = text.indexOf(string, index + 1);
  }
  return indexes;
};

/**
 * returns a string repeated a number of times
 * @param  {String} text to be repeated
 * @param  {Number} n number of repetitions
 * @return {String}
 * tags:
 */
StringOperators.repeatString = function(text, n) {
  var i;
  var newText = "";
  for(i = 0; i &lt; n; i++) {
    newText += text;
  }
  return newText;
};




//counting / statistics

/**
 * @todo finish docs
 */
StringOperators.countOccurrences = function(text, string) { //seems to be th emost efficient: http://stackoverflow.com/questions/4009756/how-to-count-string-occurrence-in-string
  var n = 0;
  var index = text.indexOf(string);
  while(index != -1) {
    n++;
    index = text.indexOf(string, index + string.length);
  }
  return n;
};

/**
 * @todo finish docs
 */
StringOperators.countWordOccurrences = function(string, word) {
  var regex = new RegExp("\\b" + word + "\\b");
  var match = string.match(regex);
  return match == null ? 0 : match.length;
};

/**
 * @todo finish docs
 */
StringOperators.countStringsOccurrences = function(text, strings) {
  var i;
  var numberList = new NumberList();
  for(i = 0; strings[i] != null; i++) {
    numberList[i] = text.split(strings[i]).length - 1;
  }
  return numberList;
};

//validation

/**
 * @todo finish docs
 */
StringOperators.validateEmail = function(text) {
  return StringOperators.MAIL_REGEX.test(text);
};

/**
 * @todo finish docs
 */
StringOperators.validateUrl = function(text) {
  return StringOperators.LINK_REGEX.test(text);
};
</code></pre>
        </article>
    </section>




      </div>
    </div>
    <div class='quiet small center pad1y'>
    </div>
  </div>
  <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="scripts/filter.js"></script>
  <script src="scripts/prettify/prettify.js"></script>
  <script src="scripts/clipboard/clipboard.js"></script>
  <script type="text/javascript">
      var copyCodes = new Clipboard('.copyCode');
  </script>
</body>
</html>
